# @restroom-mw/sawroom

A middleware to make operations on a the blockchain [Sawroom](https://github.com/dyne/sawroom), based on [Hyperledger Sawtooth](https://www.hyperledger.org/use/sawtooth) and [Zenroom](https://zenroom.org/).

## Usage

```js
import express from "express";
import zencode from "@restroom-mw/core";
import sawroom from "@restroom-mw/sawroom";

const app = express();

app.use(sawroom);
app.use("/api/*", zencode);
```

## Zencode examples

The syntax of the actions is [here](https://github.com/dyne/restroom-mw/blob/master/packages/sawroom/src/actions.ts#L1-L14).

### Store data on Sawroom

Use this **Zencode**:

```gherkin
# Here we are telling Zenroom where the Sawroom node is 
Given that I have a sawroom endpoint named 'sawroomEndpoint'

# Creating a random number for fun
When I create the random object of '128' bits
When I rename the 'random_object' to 'my128BitsRandom'

# Creating a dictionary and putting the random number in it, 
# cause like is boring and we need to spice it up
When I create the 'base64 dictionary'
and I rename the 'base64 dictionary' to 'myJSONOutput'
When I insert 'my128BitsRandom' in 'myJSONOutput'


# IMPORTANT: always print the object(s) you want to write in Sawroom
# otherwise Restroom won't be able to read them 
Then print the 'myJSONOutput'

# The following statement stores the data in Sawroom and will return 
# a key/value where the key is the name of the tag you pass to it, 
# and the value is a unique identifier of this data, that you have to store
# as you'll need it to retrieve the data from Sawroom
Then I ask Sawroom to store the data named 'myJSONOutput' into the tag 'myTag'
```

With this **keys**:

```json
{
	"sawroomEndpoint": "http://127.0.0.1:8008"
}
```

You should see an output like this:

```json
{
   "myJSONOutput": {
      "my128BitsRandom": "X4fY53EqXzNrUlGzxmpvog=="
   },
   "myTag": "c274b55db779741048483f49a65dcf292392afe7515d3b9be17883bede0bf38b2252d1"
}
```

Where you'll need **MyTag** later to retrieve the data from the blockchain.

### Read data from Sawroom

Use this **Zencode**:

```gherkin
# Here we are definining the 'endpoint' to connect where Sawroom is located
Given that I have a sawroom endpoint named 'sawroomEndpoint'

# Given I have a 'string' named 'endpoint'

# The 'batch ID' is a unique indicator to retrieve data in Sawroom, it's returned by Sawroom when writing data 
#Given I have a 'string' named 'myTag'

# Here we are formatting the output of the reading 
And I have a 'string dictionary' named 'sawroom'


# And I read the data with tag 'myTag' from sawroom and save the output into 'sawroom'
Given I read from Sawroom the data in tag 'myTag' and save the output into 'sawroom'

Then print all data
```

With this **keys**:

```json
{
	"sawroomEndpoint": "http://127.0.0.1:8008",
	"myTag": "c274b55db779741048483f49a65dcf292392afe7515d3b9be17883bede0bf38b2252d1"
}
```

## API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents
